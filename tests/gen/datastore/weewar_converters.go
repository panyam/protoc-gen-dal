// Code generated by protoc-gen-dal-datastore. DO NOT EDIT.
package datastore

import (
	api "github.com/panyam/protoc-gen-dal/tests/gen/go/api"

	"fmt"

	"github.com/panyam/protoc-gen-dal/pkg/converters"
)

// IndexInfoToIndexInfoDatastore converts a IndexInfo to IndexInfoDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source IndexInfo message to convert from
//   - dest: Destination IndexInfoDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted IndexInfoDatastore entity
//   - Error if conversion fails
func IndexInfoToIndexInfoDatastore(
	src *api.IndexInfo,
	dest *IndexInfoDatastore,
	decorator func(*api.IndexInfo, *IndexInfoDatastore) error,
) (out *IndexInfoDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &IndexInfoDatastore{}
	}

	// Initialize struct with inline values
	*dest = IndexInfoDatastore{
		NeedsIndexing: src.NeedsIndexing,
	}
	out = dest

	if src.LastUpdatedAt != nil {
		out.LastUpdatedAt = converters.TimestampToTime(src.LastUpdatedAt)
	}

	if src.LastIndexedAt != nil {
		out.LastIndexedAt = converters.TimestampToTime(src.LastIndexedAt)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// IndexInfoFromIndexInfoDatastore converts a IndexInfoDatastore back to IndexInfo.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination IndexInfo message (if nil, a new one is created)
//   - src: Source IndexInfoDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted IndexInfo message
//   - Error if conversion fails
func IndexInfoFromIndexInfoDatastore(
	dest *api.IndexInfo,
	src *IndexInfoDatastore,
	decorator func(*api.IndexInfo, *IndexInfoDatastore) error,
) (out *api.IndexInfo, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.IndexInfo{}
	}

	// Initialize struct with inline values
	*dest = api.IndexInfo{
		LastUpdatedAt: converters.TimeToTimestamp(src.LastUpdatedAt),
		LastIndexedAt: converters.TimeToTimestamp(src.LastIndexedAt),
		NeedsIndexing: src.NeedsIndexing,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// TileToTileDatastore converts a Tile to TileDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source Tile message to convert from
//   - dest: Destination TileDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted TileDatastore entity
//   - Error if conversion fails
func TileToTileDatastore(
	src *api.Tile,
	dest *TileDatastore,
	decorator func(*api.Tile, *TileDatastore) error,
) (out *TileDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &TileDatastore{}
	}

	// Initialize struct with inline values
	*dest = TileDatastore{
		Q:                src.Q,
		R:                src.R,
		TileType:         src.TileType,
		Player:           src.Player,
		Shortcut:         src.Shortcut,
		LastActedTurn:    src.LastActedTurn,
		LastToppedupTurn: src.LastToppedupTurn,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// TileFromTileDatastore converts a TileDatastore back to Tile.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination Tile message (if nil, a new one is created)
//   - src: Source TileDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted Tile message
//   - Error if conversion fails
func TileFromTileDatastore(
	dest *api.Tile,
	src *TileDatastore,
	decorator func(*api.Tile, *TileDatastore) error,
) (out *api.Tile, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Tile{}
	}

	// Initialize struct with inline values
	*dest = api.Tile{
		Q:                src.Q,
		R:                src.R,
		TileType:         src.TileType,
		Player:           src.Player,
		Shortcut:         src.Shortcut,
		LastActedTurn:    src.LastActedTurn,
		LastToppedupTurn: src.LastToppedupTurn,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UnitToUnitDatastore converts a Unit to UnitDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source Unit message to convert from
//   - dest: Destination UnitDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted UnitDatastore entity
//   - Error if conversion fails
func UnitToUnitDatastore(
	src *api.Unit,
	dest *UnitDatastore,
	decorator func(*api.Unit, *UnitDatastore) error,
) (out *UnitDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &UnitDatastore{}
	}

	// Initialize struct with inline values
	*dest = UnitDatastore{
		Q:                       src.Q,
		R:                       src.R,
		Player:                  src.Player,
		UnitType:                src.UnitType,
		Shortcut:                src.Shortcut,
		AvailableHealth:         src.AvailableHealth,
		DistanceLeft:            src.DistanceLeft,
		LastActedTurn:           src.LastActedTurn,
		LastToppedupTurn:        src.LastToppedupTurn,
		AttacksReceivedThisTurn: src.AttacksReceivedThisTurn,
		ProgressionStep:         src.ProgressionStep,
		ChosenAlternative:       src.ChosenAlternative,
	}
	out = dest

	if src.AttackHistory != nil {
		out.AttackHistory = make([]AttackRecordDatastore, len(src.AttackHistory))
		for i, item := range src.AttackHistory {
			_, err = AttackRecordToAttackRecordDatastore(item, &out.AttackHistory[i], nil)
			if err != nil {
				return nil, fmt.Errorf("converting AttackHistory[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UnitFromUnitDatastore converts a UnitDatastore back to Unit.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination Unit message (if nil, a new one is created)
//   - src: Source UnitDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted Unit message
//   - Error if conversion fails
func UnitFromUnitDatastore(
	dest *api.Unit,
	src *UnitDatastore,
	decorator func(*api.Unit, *UnitDatastore) error,
) (out *api.Unit, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Unit{}
	}

	// Initialize struct with inline values
	*dest = api.Unit{
		Q:                       src.Q,
		R:                       src.R,
		Player:                  src.Player,
		UnitType:                src.UnitType,
		Shortcut:                src.Shortcut,
		AvailableHealth:         src.AvailableHealth,
		DistanceLeft:            src.DistanceLeft,
		LastActedTurn:           src.LastActedTurn,
		LastToppedupTurn:        src.LastToppedupTurn,
		AttacksReceivedThisTurn: src.AttacksReceivedThisTurn,
		ProgressionStep:         src.ProgressionStep,
		ChosenAlternative:       src.ChosenAlternative,
	}
	out = dest

	if src.AttackHistory != nil {
		out.AttackHistory = make([]*api.AttackRecord, len(src.AttackHistory))
		for i, item := range src.AttackHistory {
			out.AttackHistory[i], err = AttackRecordFromAttackRecordDatastore(nil, &item, nil)
			if err != nil {
				return nil, fmt.Errorf("converting AttackHistory[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// AttackRecordToAttackRecordDatastore converts a AttackRecord to AttackRecordDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source AttackRecord message to convert from
//   - dest: Destination AttackRecordDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted AttackRecordDatastore entity
//   - Error if conversion fails
func AttackRecordToAttackRecordDatastore(
	src *api.AttackRecord,
	dest *AttackRecordDatastore,
	decorator func(*api.AttackRecord, *AttackRecordDatastore) error,
) (out *AttackRecordDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &AttackRecordDatastore{}
	}

	// Initialize struct with inline values
	*dest = AttackRecordDatastore{
		Q:          src.Q,
		R:          src.R,
		IsRanged:   src.IsRanged,
		TurnNumber: src.TurnNumber,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// AttackRecordFromAttackRecordDatastore converts a AttackRecordDatastore back to AttackRecord.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination AttackRecord message (if nil, a new one is created)
//   - src: Source AttackRecordDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted AttackRecord message
//   - Error if conversion fails
func AttackRecordFromAttackRecordDatastore(
	dest *api.AttackRecord,
	src *AttackRecordDatastore,
	decorator func(*api.AttackRecord, *AttackRecordDatastore) error,
) (out *api.AttackRecord, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.AttackRecord{}
	}

	// Initialize struct with inline values
	*dest = api.AttackRecord{
		Q:          src.Q,
		R:          src.R,
		IsRanged:   src.IsRanged,
		TurnNumber: src.TurnNumber,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// WorldToWorldDatastore converts a World to WorldDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source World message to convert from
//   - dest: Destination WorldDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted WorldDatastore entity
//   - Error if conversion fails
func WorldToWorldDatastore(
	src *api.World,
	dest *WorldDatastore,
	decorator func(*api.World, *WorldDatastore) error,
) (out *WorldDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &WorldDatastore{}
	}

	// Initialize struct with inline values
	*dest = WorldDatastore{
		Id:          src.Id,
		CreatorId:   src.CreatorId,
		Name:        src.Name,
		Description: src.Description,
		Tags:        src.Tags,
		ImageUrl:    src.ImageUrl,
		Difficulty:  src.Difficulty,
		PreviewUrls: src.PreviewUrls,
	}
	out = dest

	if src.CreatedAt != nil {
		out.CreatedAt = converters.TimestampToTime(src.CreatedAt)
	}

	if src.UpdatedAt != nil {
		out.UpdatedAt = converters.TimestampToTime(src.UpdatedAt)
	}

	if src.WorldData != nil {
		_, err = WorldDataToWorldDataDatastore(src.WorldData, &out.WorldData, nil)
		if err != nil {
			return nil, fmt.Errorf("converting WorldData: %w", err)
		}
	}
	if src.DefaultGameConfig != nil {
		_, err = GameConfigurationToGameConfigurationDatastore(src.DefaultGameConfig, &out.DefaultGameConfig, nil)
		if err != nil {
			return nil, fmt.Errorf("converting DefaultGameConfig: %w", err)
		}
	}
	if src.ScreenshotIndexInfo != nil {
		_, err = IndexInfoToIndexInfoDatastore(src.ScreenshotIndexInfo, &out.ScreenshotIndexInfo, nil)
		if err != nil {
			return nil, fmt.Errorf("converting ScreenshotIndexInfo: %w", err)
		}
	}
	if src.SearchIndexInfo != nil {
		_, err = IndexInfoToIndexInfoDatastore(src.SearchIndexInfo, &out.SearchIndexInfo, nil)
		if err != nil {
			return nil, fmt.Errorf("converting SearchIndexInfo: %w", err)
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// WorldFromWorldDatastore converts a WorldDatastore back to World.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination World message (if nil, a new one is created)
//   - src: Source WorldDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted World message
//   - Error if conversion fails
func WorldFromWorldDatastore(
	dest *api.World,
	src *WorldDatastore,
	decorator func(*api.World, *WorldDatastore) error,
) (out *api.World, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.World{}
	}

	// Initialize struct with inline values
	*dest = api.World{
		CreatedAt:   converters.TimeToTimestamp(src.CreatedAt),
		UpdatedAt:   converters.TimeToTimestamp(src.UpdatedAt),
		Id:          src.Id,
		CreatorId:   src.CreatorId,
		Name:        src.Name,
		Description: src.Description,
		Tags:        src.Tags,
		ImageUrl:    src.ImageUrl,
		Difficulty:  src.Difficulty,
		PreviewUrls: src.PreviewUrls,
	}
	out = dest

	_, err = WorldDataFromWorldDataDatastore(out.WorldData, &src.WorldData, nil)
	if err != nil {
		return nil, fmt.Errorf("converting WorldData: %w", err)
	}

	_, err = GameConfigurationFromGameConfigurationDatastore(out.DefaultGameConfig, &src.DefaultGameConfig, nil)
	if err != nil {
		return nil, fmt.Errorf("converting DefaultGameConfig: %w", err)
	}

	_, err = IndexInfoFromIndexInfoDatastore(out.ScreenshotIndexInfo, &src.ScreenshotIndexInfo, nil)
	if err != nil {
		return nil, fmt.Errorf("converting ScreenshotIndexInfo: %w", err)
	}

	_, err = IndexInfoFromIndexInfoDatastore(out.SearchIndexInfo, &src.SearchIndexInfo, nil)
	if err != nil {
		return nil, fmt.Errorf("converting SearchIndexInfo: %w", err)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// WorldDataToWorldDataDatastore converts a WorldData to WorldDataDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source WorldData message to convert from
//   - dest: Destination WorldDataDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted WorldDataDatastore entity
//   - Error if conversion fails
func WorldDataToWorldDataDatastore(
	src *api.WorldData,
	dest *WorldDataDatastore,
	decorator func(*api.WorldData, *WorldDataDatastore) error,
) (out *WorldDataDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &WorldDataDatastore{}
	}

	// Initialize struct with inline values
	*dest = WorldDataDatastore{}
	out = dest

	if src.Tiles != nil {
		out.Tiles = make([]TileDatastore, len(src.Tiles))
		for i, item := range src.Tiles {
			_, err = TileToTileDatastore(item, &out.Tiles[i], nil)
			if err != nil {
				return nil, fmt.Errorf("converting Tiles[%d]: %w", i, err)
			}
		}
	}
	if src.Units != nil {
		out.Units = make([]UnitDatastore, len(src.Units))
		for i, item := range src.Units {
			_, err = UnitToUnitDatastore(item, &out.Units[i], nil)
			if err != nil {
				return nil, fmt.Errorf("converting Units[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// WorldDataFromWorldDataDatastore converts a WorldDataDatastore back to WorldData.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination WorldData message (if nil, a new one is created)
//   - src: Source WorldDataDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted WorldData message
//   - Error if conversion fails
func WorldDataFromWorldDataDatastore(
	dest *api.WorldData,
	src *WorldDataDatastore,
	decorator func(*api.WorldData, *WorldDataDatastore) error,
) (out *api.WorldData, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.WorldData{}
	}

	// Initialize struct with inline values
	*dest = api.WorldData{}
	out = dest

	if src.Tiles != nil {
		out.Tiles = make([]*api.Tile, len(src.Tiles))
		for i, item := range src.Tiles {
			out.Tiles[i], err = TileFromTileDatastore(nil, &item, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Tiles[%d]: %w", i, err)
			}
		}
	}
	if src.Units != nil {
		out.Units = make([]*api.Unit, len(src.Units))
		for i, item := range src.Units {
			out.Units[i], err = UnitFromUnitDatastore(nil, &item, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Units[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameToGameDatastore converts a Game to GameDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source Game message to convert from
//   - dest: Destination GameDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameDatastore entity
//   - Error if conversion fails
func GameToGameDatastore(
	src *api.Game,
	dest *GameDatastore,
	decorator func(*api.Game, *GameDatastore) error,
) (out *GameDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &GameDatastore{}
	}

	// Initialize struct with inline values
	*dest = GameDatastore{
		Id:          src.Id,
		CreatorId:   src.CreatorId,
		WorldId:     src.WorldId,
		Name:        src.Name,
		Description: src.Description,
		Tags:        src.Tags,
		ImageUrl:    src.ImageUrl,
		Difficulty:  src.Difficulty,
		PreviewUrls: src.PreviewUrls,
	}
	out = dest

	if src.CreatedAt != nil {
		out.CreatedAt = converters.TimestampToTime(src.CreatedAt)
	}

	if src.UpdatedAt != nil {
		out.UpdatedAt = converters.TimestampToTime(src.UpdatedAt)
	}

	if src.Config != nil {
		_, err = GameConfigurationToGameConfigurationDatastore(src.Config, &out.Config, nil)
		if err != nil {
			return nil, fmt.Errorf("converting Config: %w", err)
		}
	}
	if src.ScreenshotIndexInfo != nil {
		_, err = IndexInfoToIndexInfoDatastore(src.ScreenshotIndexInfo, &out.ScreenshotIndexInfo, nil)
		if err != nil {
			return nil, fmt.Errorf("converting ScreenshotIndexInfo: %w", err)
		}
	}
	if src.SearchIndexInfo != nil {
		_, err = IndexInfoToIndexInfoDatastore(src.SearchIndexInfo, &out.SearchIndexInfo, nil)
		if err != nil {
			return nil, fmt.Errorf("converting SearchIndexInfo: %w", err)
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameFromGameDatastore converts a GameDatastore back to Game.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination Game message (if nil, a new one is created)
//   - src: Source GameDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted Game message
//   - Error if conversion fails
func GameFromGameDatastore(
	dest *api.Game,
	src *GameDatastore,
	decorator func(*api.Game, *GameDatastore) error,
) (out *api.Game, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Game{}
	}

	// Initialize struct with inline values
	*dest = api.Game{
		CreatedAt:   converters.TimeToTimestamp(src.CreatedAt),
		UpdatedAt:   converters.TimeToTimestamp(src.UpdatedAt),
		Id:          src.Id,
		CreatorId:   src.CreatorId,
		WorldId:     src.WorldId,
		Name:        src.Name,
		Description: src.Description,
		Tags:        src.Tags,
		ImageUrl:    src.ImageUrl,
		Difficulty:  src.Difficulty,
		PreviewUrls: src.PreviewUrls,
	}
	out = dest

	_, err = GameConfigurationFromGameConfigurationDatastore(out.Config, &src.Config, nil)
	if err != nil {
		return nil, fmt.Errorf("converting Config: %w", err)
	}

	_, err = IndexInfoFromIndexInfoDatastore(out.ScreenshotIndexInfo, &src.ScreenshotIndexInfo, nil)
	if err != nil {
		return nil, fmt.Errorf("converting ScreenshotIndexInfo: %w", err)
	}

	_, err = IndexInfoFromIndexInfoDatastore(out.SearchIndexInfo, &src.SearchIndexInfo, nil)
	if err != nil {
		return nil, fmt.Errorf("converting SearchIndexInfo: %w", err)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameConfigurationToGameConfigurationDatastore converts a GameConfiguration to GameConfigurationDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source GameConfiguration message to convert from
//   - dest: Destination GameConfigurationDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameConfigurationDatastore entity
//   - Error if conversion fails
func GameConfigurationToGameConfigurationDatastore(
	src *api.GameConfiguration,
	dest *GameConfigurationDatastore,
	decorator func(*api.GameConfiguration, *GameConfigurationDatastore) error,
) (out *GameConfigurationDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &GameConfigurationDatastore{}
	}

	// Initialize struct with inline values
	*dest = GameConfigurationDatastore{}
	out = dest

	if src.IncomeConfigs != nil {
		_, err = IncomeConfigToIncomeConfigDatastore(src.IncomeConfigs, &out.IncomeConfigs, nil)
		if err != nil {
			return nil, fmt.Errorf("converting IncomeConfigs: %w", err)
		}
	}
	if src.Settings != nil {
		_, err = GameSettingsToGameSettingsDatastore(src.Settings, &out.Settings, nil)
		if err != nil {
			return nil, fmt.Errorf("converting Settings: %w", err)
		}
	}

	if src.Players != nil {
		out.Players = make([]GamePlayerDatastore, len(src.Players))
		for i, item := range src.Players {
			_, err = GamePlayerToGamePlayerDatastore(item, &out.Players[i], nil)
			if err != nil {
				return nil, fmt.Errorf("converting Players[%d]: %w", i, err)
			}
		}
	}
	if src.Teams != nil {
		out.Teams = make([]GameTeamDatastore, len(src.Teams))
		for i, item := range src.Teams {
			_, err = GameTeamToGameTeamDatastore(item, &out.Teams[i], nil)
			if err != nil {
				return nil, fmt.Errorf("converting Teams[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameConfigurationFromGameConfigurationDatastore converts a GameConfigurationDatastore back to GameConfiguration.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination GameConfiguration message (if nil, a new one is created)
//   - src: Source GameConfigurationDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameConfiguration message
//   - Error if conversion fails
func GameConfigurationFromGameConfigurationDatastore(
	dest *api.GameConfiguration,
	src *GameConfigurationDatastore,
	decorator func(*api.GameConfiguration, *GameConfigurationDatastore) error,
) (out *api.GameConfiguration, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.GameConfiguration{}
	}

	// Initialize struct with inline values
	*dest = api.GameConfiguration{}
	out = dest

	_, err = IncomeConfigFromIncomeConfigDatastore(out.IncomeConfigs, &src.IncomeConfigs, nil)
	if err != nil {
		return nil, fmt.Errorf("converting IncomeConfigs: %w", err)
	}

	_, err = GameSettingsFromGameSettingsDatastore(out.Settings, &src.Settings, nil)
	if err != nil {
		return nil, fmt.Errorf("converting Settings: %w", err)
	}

	if src.Players != nil {
		out.Players = make([]*api.GamePlayer, len(src.Players))
		for i, item := range src.Players {
			out.Players[i], err = GamePlayerFromGamePlayerDatastore(nil, &item, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Players[%d]: %w", i, err)
			}
		}
	}
	if src.Teams != nil {
		out.Teams = make([]*api.GameTeam, len(src.Teams))
		for i, item := range src.Teams {
			out.Teams[i], err = GameTeamFromGameTeamDatastore(nil, &item, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Teams[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// IncomeConfigToIncomeConfigDatastore converts a IncomeConfig to IncomeConfigDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source IncomeConfig message to convert from
//   - dest: Destination IncomeConfigDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted IncomeConfigDatastore entity
//   - Error if conversion fails
func IncomeConfigToIncomeConfigDatastore(
	src *api.IncomeConfig,
	dest *IncomeConfigDatastore,
	decorator func(*api.IncomeConfig, *IncomeConfigDatastore) error,
) (out *IncomeConfigDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &IncomeConfigDatastore{}
	}

	// Initialize struct with inline values
	*dest = IncomeConfigDatastore{
		StartingCoins:     src.StartingCoins,
		GameIncome:        src.GameIncome,
		LandbaseIncome:    src.LandbaseIncome,
		NavalbaseIncome:   src.NavalbaseIncome,
		AirportbaseIncome: src.AirportbaseIncome,
		MissilesiloIncome: src.MissilesiloIncome,
		MinesIncome:       src.MinesIncome,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// IncomeConfigFromIncomeConfigDatastore converts a IncomeConfigDatastore back to IncomeConfig.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination IncomeConfig message (if nil, a new one is created)
//   - src: Source IncomeConfigDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted IncomeConfig message
//   - Error if conversion fails
func IncomeConfigFromIncomeConfigDatastore(
	dest *api.IncomeConfig,
	src *IncomeConfigDatastore,
	decorator func(*api.IncomeConfig, *IncomeConfigDatastore) error,
) (out *api.IncomeConfig, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.IncomeConfig{}
	}

	// Initialize struct with inline values
	*dest = api.IncomeConfig{
		StartingCoins:     src.StartingCoins,
		GameIncome:        src.GameIncome,
		LandbaseIncome:    src.LandbaseIncome,
		NavalbaseIncome:   src.NavalbaseIncome,
		AirportbaseIncome: src.AirportbaseIncome,
		MissilesiloIncome: src.MissilesiloIncome,
		MinesIncome:       src.MinesIncome,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GamePlayerToGamePlayerDatastore converts a GamePlayer to GamePlayerDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source GamePlayer message to convert from
//   - dest: Destination GamePlayerDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GamePlayerDatastore entity
//   - Error if conversion fails
func GamePlayerToGamePlayerDatastore(
	src *api.GamePlayer,
	dest *GamePlayerDatastore,
	decorator func(*api.GamePlayer, *GamePlayerDatastore) error,
) (out *GamePlayerDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &GamePlayerDatastore{}
	}

	// Initialize struct with inline values
	*dest = GamePlayerDatastore{
		PlayerId:      src.PlayerId,
		PlayerType:    src.PlayerType,
		Color:         src.Color,
		TeamId:        src.TeamId,
		Name:          src.Name,
		IsActive:      src.IsActive,
		StartingCoins: src.StartingCoins,
		Coins:         src.Coins,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GamePlayerFromGamePlayerDatastore converts a GamePlayerDatastore back to GamePlayer.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination GamePlayer message (if nil, a new one is created)
//   - src: Source GamePlayerDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GamePlayer message
//   - Error if conversion fails
func GamePlayerFromGamePlayerDatastore(
	dest *api.GamePlayer,
	src *GamePlayerDatastore,
	decorator func(*api.GamePlayer, *GamePlayerDatastore) error,
) (out *api.GamePlayer, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.GamePlayer{}
	}

	// Initialize struct with inline values
	*dest = api.GamePlayer{
		PlayerId:      src.PlayerId,
		PlayerType:    src.PlayerType,
		Color:         src.Color,
		TeamId:        src.TeamId,
		Name:          src.Name,
		IsActive:      src.IsActive,
		StartingCoins: src.StartingCoins,
		Coins:         src.Coins,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameTeamToGameTeamDatastore converts a GameTeam to GameTeamDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source GameTeam message to convert from
//   - dest: Destination GameTeamDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameTeamDatastore entity
//   - Error if conversion fails
func GameTeamToGameTeamDatastore(
	src *api.GameTeam,
	dest *GameTeamDatastore,
	decorator func(*api.GameTeam, *GameTeamDatastore) error,
) (out *GameTeamDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &GameTeamDatastore{}
	}

	// Initialize struct with inline values
	*dest = GameTeamDatastore{
		TeamId:   src.TeamId,
		Name:     src.Name,
		Color:    src.Color,
		IsActive: src.IsActive,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameTeamFromGameTeamDatastore converts a GameTeamDatastore back to GameTeam.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination GameTeam message (if nil, a new one is created)
//   - src: Source GameTeamDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameTeam message
//   - Error if conversion fails
func GameTeamFromGameTeamDatastore(
	dest *api.GameTeam,
	src *GameTeamDatastore,
	decorator func(*api.GameTeam, *GameTeamDatastore) error,
) (out *api.GameTeam, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.GameTeam{}
	}

	// Initialize struct with inline values
	*dest = api.GameTeam{
		TeamId:   src.TeamId,
		Name:     src.Name,
		Color:    src.Color,
		IsActive: src.IsActive,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameSettingsToGameSettingsDatastore converts a GameSettings to GameSettingsDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source GameSettings message to convert from
//   - dest: Destination GameSettingsDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameSettingsDatastore entity
//   - Error if conversion fails
func GameSettingsToGameSettingsDatastore(
	src *api.GameSettings,
	dest *GameSettingsDatastore,
	decorator func(*api.GameSettings, *GameSettingsDatastore) error,
) (out *GameSettingsDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &GameSettingsDatastore{}
	}

	// Initialize struct with inline values
	*dest = GameSettingsDatastore{
		AllowedUnits:  src.AllowedUnits,
		TurnTimeLimit: src.TurnTimeLimit,
		TeamMode:      src.TeamMode,
		MaxTurns:      src.MaxTurns,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameSettingsFromGameSettingsDatastore converts a GameSettingsDatastore back to GameSettings.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination GameSettings message (if nil, a new one is created)
//   - src: Source GameSettingsDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameSettings message
//   - Error if conversion fails
func GameSettingsFromGameSettingsDatastore(
	dest *api.GameSettings,
	src *GameSettingsDatastore,
	decorator func(*api.GameSettings, *GameSettingsDatastore) error,
) (out *api.GameSettings, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.GameSettings{}
	}

	// Initialize struct with inline values
	*dest = api.GameSettings{
		AllowedUnits:  src.AllowedUnits,
		TurnTimeLimit: src.TurnTimeLimit,
		TeamMode:      src.TeamMode,
		MaxTurns:      src.MaxTurns,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameStateToGameStateDatastore converts a GameState to GameStateDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source GameState message to convert from
//   - dest: Destination GameStateDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameStateDatastore entity
//   - Error if conversion fails
func GameStateToGameStateDatastore(
	src *api.GameState,
	dest *GameStateDatastore,
	decorator func(*api.GameState, *GameStateDatastore) error,
) (out *GameStateDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &GameStateDatastore{}
	}

	// Initialize struct with inline values
	*dest = GameStateDatastore{
		GameId:        src.GameId,
		TurnCounter:   src.TurnCounter,
		CurrentPlayer: src.CurrentPlayer,
		StateHash:     src.StateHash,
		Version:       src.Version,
		Status:        src.Status,
		Finished:      src.Finished,
		WinningPlayer: src.WinningPlayer,
		WinningTeam:   src.WinningTeam,
	}
	out = dest

	if src.UpdatedAt != nil {
		out.UpdatedAt = converters.TimestampToTime(src.UpdatedAt)
	}

	if src.WorldData != nil {
		_, err = WorldDataToWorldDataDatastore(src.WorldData, &out.WorldData, nil)
		if err != nil {
			return nil, fmt.Errorf("converting WorldData: %w", err)
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameStateFromGameStateDatastore converts a GameStateDatastore back to GameState.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination GameState message (if nil, a new one is created)
//   - src: Source GameStateDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameState message
//   - Error if conversion fails
func GameStateFromGameStateDatastore(
	dest *api.GameState,
	src *GameStateDatastore,
	decorator func(*api.GameState, *GameStateDatastore) error,
) (out *api.GameState, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.GameState{}
	}

	// Initialize struct with inline values
	*dest = api.GameState{
		UpdatedAt:     converters.TimeToTimestamp(src.UpdatedAt),
		GameId:        src.GameId,
		TurnCounter:   src.TurnCounter,
		CurrentPlayer: src.CurrentPlayer,
		StateHash:     src.StateHash,
		Version:       src.Version,
		Status:        src.Status,
		Finished:      src.Finished,
		WinningPlayer: src.WinningPlayer,
		WinningTeam:   src.WinningTeam,
	}
	out = dest

	_, err = WorldDataFromWorldDataDatastore(out.WorldData, &src.WorldData, nil)
	if err != nil {
		return nil, fmt.Errorf("converting WorldData: %w", err)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameMoveHistoryToGameMoveHistoryDatastore converts a GameMoveHistory to GameMoveHistoryDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source GameMoveHistory message to convert from
//   - dest: Destination GameMoveHistoryDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameMoveHistoryDatastore entity
//   - Error if conversion fails
func GameMoveHistoryToGameMoveHistoryDatastore(
	src *api.GameMoveHistory,
	dest *GameMoveHistoryDatastore,
	decorator func(*api.GameMoveHistory, *GameMoveHistoryDatastore) error,
) (out *GameMoveHistoryDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &GameMoveHistoryDatastore{}
	}

	// Initialize struct with inline values
	*dest = GameMoveHistoryDatastore{
		GameId: src.GameId,
	}
	out = dest

	if src.Groups != nil {
		out.Groups = make([]GameMoveGroupDatastore, len(src.Groups))
		for i, item := range src.Groups {
			_, err = GameMoveGroupToGameMoveGroupDatastore(item, &out.Groups[i], nil)
			if err != nil {
				return nil, fmt.Errorf("converting Groups[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameMoveHistoryFromGameMoveHistoryDatastore converts a GameMoveHistoryDatastore back to GameMoveHistory.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination GameMoveHistory message (if nil, a new one is created)
//   - src: Source GameMoveHistoryDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameMoveHistory message
//   - Error if conversion fails
func GameMoveHistoryFromGameMoveHistoryDatastore(
	dest *api.GameMoveHistory,
	src *GameMoveHistoryDatastore,
	decorator func(*api.GameMoveHistory, *GameMoveHistoryDatastore) error,
) (out *api.GameMoveHistory, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.GameMoveHistory{}
	}

	// Initialize struct with inline values
	*dest = api.GameMoveHistory{
		GameId: src.GameId,
	}
	out = dest

	if src.Groups != nil {
		out.Groups = make([]*api.GameMoveGroup, len(src.Groups))
		for i, item := range src.Groups {
			out.Groups[i], err = GameMoveGroupFromGameMoveGroupDatastore(nil, &item, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Groups[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameMoveGroupToGameMoveGroupDatastore converts a GameMoveGroup to GameMoveGroupDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source GameMoveGroup message to convert from
//   - dest: Destination GameMoveGroupDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameMoveGroupDatastore entity
//   - Error if conversion fails
func GameMoveGroupToGameMoveGroupDatastore(
	src *api.GameMoveGroup,
	dest *GameMoveGroupDatastore,
	decorator func(*api.GameMoveGroup, *GameMoveGroupDatastore) error,
) (out *GameMoveGroupDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &GameMoveGroupDatastore{}
	}

	// Initialize struct with inline values
	*dest = GameMoveGroupDatastore{}
	out = dest

	if src.StartedAt != nil {
		out.StartedAt = converters.TimestampToTime(src.StartedAt)
	}

	if src.EndedAt != nil {
		out.EndedAt = converters.TimestampToTime(src.EndedAt)
	}

	if src.Moves != nil {
		out.Moves = make([]GameMoveDatastore, len(src.Moves))
		for i, item := range src.Moves {
			_, err = GameMoveToGameMoveDatastore(item, &out.Moves[i], nil)
			if err != nil {
				return nil, fmt.Errorf("converting Moves[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameMoveGroupFromGameMoveGroupDatastore converts a GameMoveGroupDatastore back to GameMoveGroup.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination GameMoveGroup message (if nil, a new one is created)
//   - src: Source GameMoveGroupDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameMoveGroup message
//   - Error if conversion fails
func GameMoveGroupFromGameMoveGroupDatastore(
	dest *api.GameMoveGroup,
	src *GameMoveGroupDatastore,
	decorator func(*api.GameMoveGroup, *GameMoveGroupDatastore) error,
) (out *api.GameMoveGroup, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.GameMoveGroup{}
	}

	// Initialize struct with inline values
	*dest = api.GameMoveGroup{
		StartedAt: converters.TimeToTimestamp(src.StartedAt),
		EndedAt:   converters.TimeToTimestamp(src.EndedAt),
	}
	out = dest

	if src.Moves != nil {
		out.Moves = make([]*api.GameMove, len(src.Moves))
		for i, item := range src.Moves {
			out.Moves[i], err = GameMoveFromGameMoveDatastore(nil, &item, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Moves[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// MoveUnitActionToMoveUnitActionDatastore converts a MoveUnitAction to MoveUnitActionDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source MoveUnitAction message to convert from
//   - dest: Destination MoveUnitActionDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted MoveUnitActionDatastore entity
//   - Error if conversion fails
func MoveUnitActionToMoveUnitActionDatastore(
	src *api.MoveUnitAction,
	dest *MoveUnitActionDatastore,
	decorator func(*api.MoveUnitAction, *MoveUnitActionDatastore) error,
) (out *MoveUnitActionDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &MoveUnitActionDatastore{}
	}

	// Initialize struct with inline values
	*dest = MoveUnitActionDatastore{
		FromQ:        src.FromQ,
		FromR:        src.FromR,
		ToQ:          src.ToQ,
		ToR:          src.ToR,
		MovementCost: src.MovementCost,
	}
	out = dest

	if src.ReconstructedPath != nil {
		out.ReconstructedPath, err = converters.MessageToAnyBytes(src.ReconstructedPath)
		if err != nil {
			return nil, fmt.Errorf("converting ReconstructedPath: %w", err)
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// MoveUnitActionFromMoveUnitActionDatastore converts a MoveUnitActionDatastore back to MoveUnitAction.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination MoveUnitAction message (if nil, a new one is created)
//   - src: Source MoveUnitActionDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted MoveUnitAction message
//   - Error if conversion fails
func MoveUnitActionFromMoveUnitActionDatastore(
	dest *api.MoveUnitAction,
	src *MoveUnitActionDatastore,
	decorator func(*api.MoveUnitAction, *MoveUnitActionDatastore) error,
) (out *api.MoveUnitAction, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.MoveUnitAction{}
	}

	// Initialize struct with inline values
	*dest = api.MoveUnitAction{
		FromQ:        src.FromQ,
		FromR:        src.FromR,
		ToQ:          src.ToQ,
		ToR:          src.ToR,
		MovementCost: src.MovementCost,
	}
	out = dest

	if src.ReconstructedPath != nil {
		out.ReconstructedPath, err = converters.AnyBytesToMessage[*api.Path](src.ReconstructedPath)
		if err != nil {
			return nil, fmt.Errorf("converting ReconstructedPath: %w", err)
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameMoveToGameMoveDatastore converts a GameMove to GameMoveDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source GameMove message to convert from
//   - dest: Destination GameMoveDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameMoveDatastore entity
//   - Error if conversion fails
func GameMoveToGameMoveDatastore(
	src *api.GameMove,
	dest *GameMoveDatastore,
	decorator func(*api.GameMove, *GameMoveDatastore) error,
) (out *GameMoveDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &GameMoveDatastore{}
	}

	// Initialize struct with inline values
	*dest = GameMoveDatastore{
		Player:      src.Player,
		SequenceNum: src.SequenceNum,
		IsPermanent: src.IsPermanent,
	}
	out = dest

	if src.Timestamp != nil {
		out.Timestamp = converters.TimestampToTime(src.Timestamp)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// GameMoveFromGameMoveDatastore converts a GameMoveDatastore back to GameMove.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination GameMove message (if nil, a new one is created)
//   - src: Source GameMoveDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted GameMove message
//   - Error if conversion fails
func GameMoveFromGameMoveDatastore(
	dest *api.GameMove,
	src *GameMoveDatastore,
	decorator func(*api.GameMove, *GameMoveDatastore) error,
) (out *api.GameMove, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.GameMove{}
	}

	// Initialize struct with inline values
	*dest = api.GameMove{
		Player:      src.Player,
		Timestamp:   converters.TimeToTimestamp(src.Timestamp),
		SequenceNum: src.SequenceNum,
		IsPermanent: src.IsPermanent,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}
