// Code generated by protoc-gen-dal-datastore. DO NOT EDIT.
package datastore

import (
	"fmt"

	api "github.com/panyam/protoc-gen-dal/tests/gen/go/api"

	"github.com/panyam/protoc-gen-dal/pkg/converters"
)

// TestRecord1ToTestRecord1Datastore converts a TestRecord1 to TestRecord1Datastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source TestRecord1 message to convert from
//   - dest: Destination TestRecord1Datastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted TestRecord1Datastore entity
//   - Error if conversion fails
func TestRecord1ToTestRecord1Datastore(
	src *api.TestRecord1,
	dest *TestRecord1Datastore,
	decorator func(*api.TestRecord1, *TestRecord1Datastore) error,
) (out *TestRecord1Datastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &TestRecord1Datastore{}
	}

	// Initialize struct with inline values
	*dest = TestRecord1Datastore{}
	out = dest

	if src.TimeField != nil {
		out.TimeField = converters.TimestampToTime(src.TimeField)
	}
	if src.ExtraData != nil {
		out.ExtraData, err = converters.AnyToBytes(src.ExtraData)
		if err != nil {
			return nil, fmt.Errorf("converting ExtraData: %w", err)
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// TestRecord1FromTestRecord1Datastore converts a TestRecord1Datastore back to TestRecord1.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination TestRecord1 message (if nil, a new one is created)
//   - src: Source TestRecord1Datastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted TestRecord1 message
//   - Error if conversion fails
func TestRecord1FromTestRecord1Datastore(
	dest *api.TestRecord1,
	src *TestRecord1Datastore,
	decorator func(*api.TestRecord1, *TestRecord1Datastore) error,
) (out *api.TestRecord1, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.TestRecord1{}
	}

	// Initialize struct with inline values
	*dest = api.TestRecord1{
		TimeField: converters.TimeToTimestamp(src.TimeField),
	}
	out = dest

	if src.ExtraData != nil {
		out.ExtraData, err = converters.BytesToAny(src.ExtraData)
		if err != nil {
			return nil, fmt.Errorf("converting ExtraData: %w", err)
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}
