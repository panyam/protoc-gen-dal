// Code generated by protoc-gen-dal-datastore. DO NOT EDIT.
package datastore

import (
	api "github.com/panyam/protoc-gen-dal/tests/gen/go/api"

	"fmt"
	"strconv"
	"time"

	"google.golang.org/protobuf/types/known/timestamppb"
)

// Helper functions for type conversions

// timestampToInt64 converts a protobuf Timestamp to Unix seconds (int64).
func timestampToInt64(ts *timestamppb.Timestamp) int64 {
	if ts == nil {
		return 0
	}
	return ts.AsTime().Unix()
}

// int64ToTimestamp converts Unix seconds to a protobuf Timestamp.
func int64ToTimestamp(seconds int64) *timestamppb.Timestamp {
	if seconds == 0 {
		return nil
	}
	return timestamppb.New(time.Unix(seconds, 0))
}

// mustParseUint parses a string to uint64, panics on error (for generated code).
func mustParseUint(s string) uint64 {
	val, err := strconv.ParseUint(s, 10, 32)
	if err != nil {
		panic("failed to parse uint: " + err.Error())
	}
	return val
}

// UserToUserDatastore converts a User to UserDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source User message to convert from
//   - dest: Destination UserDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted UserDatastore entity
//   - Error if conversion fails
func UserToUserDatastore(
	src *api.User,
	dest *UserDatastore,
	decorator func(*api.User, *UserDatastore) error,
) (out *UserDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &UserDatastore{}
	}

	// Initialize struct with inline values
	*dest = UserDatastore{
		Id:    strconv.FormatUint(uint64(src.Id), 10),
		Name:  src.Name,
		Email: src.Email,
		Age:   src.Age,
	}
	out = dest

	if src.Birthday != nil {
		out.Birthday = timestampToInt64(src.Birthday)
	}
	if src.CreatedAt != nil {
		out.CreatedAt = timestampToInt64(src.CreatedAt)
	}
	if src.UpdatedAt != nil {
		out.UpdatedAt = timestampToInt64(src.UpdatedAt)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserFromUserDatastore converts a UserDatastore back to User.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination User message (if nil, a new one is created)
//   - src: Source UserDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted User message
//   - Error if conversion fails
func UserFromUserDatastore(
	dest *api.User,
	src *UserDatastore,
	decorator func(*api.User, *UserDatastore) error,
) (out *api.User, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.User{}
	}

	// Initialize struct with inline values
	*dest = api.User{
		Id:        uint32(mustParseUint(src.Id)),
		Name:      src.Name,
		Email:     src.Email,
		Age:       src.Age,
		Birthday:  int64ToTimestamp(src.Birthday),
		CreatedAt: int64ToTimestamp(src.CreatedAt),
		UpdatedAt: int64ToTimestamp(src.UpdatedAt),
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserToUserWithNamespace converts a User to UserWithNamespace.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source User message to convert from
//   - dest: Destination UserWithNamespace entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted UserWithNamespace entity
//   - Error if conversion fails
func UserToUserWithNamespace(
	src *api.User,
	dest *UserWithNamespace,
	decorator func(*api.User, *UserWithNamespace) error,
) (out *UserWithNamespace, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &UserWithNamespace{}
	}

	// Initialize struct with inline values
	*dest = UserWithNamespace{
		Id:    strconv.FormatUint(uint64(src.Id), 10),
		Name:  src.Name,
		Email: src.Email,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserFromUserWithNamespace converts a UserWithNamespace back to User.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination User message (if nil, a new one is created)
//   - src: Source UserWithNamespace entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted User message
//   - Error if conversion fails
func UserFromUserWithNamespace(
	dest *api.User,
	src *UserWithNamespace,
	decorator func(*api.User, *UserWithNamespace) error,
) (out *api.User, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.User{}
	}

	// Initialize struct with inline values
	*dest = api.User{
		Id:    uint32(mustParseUint(src.Id)),
		Name:  src.Name,
		Email: src.Email,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserToUserWithLargeText converts a User to UserWithLargeText.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source User message to convert from
//   - dest: Destination UserWithLargeText entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted UserWithLargeText entity
//   - Error if conversion fails
func UserToUserWithLargeText(
	src *api.User,
	dest *UserWithLargeText,
	decorator func(*api.User, *UserWithLargeText) error,
) (out *UserWithLargeText, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &UserWithLargeText{}
	}

	// Initialize struct with inline values
	*dest = UserWithLargeText{
		Id:    strconv.FormatUint(uint64(src.Id), 10),
		Name:  src.Name,
		Email: src.Email,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserFromUserWithLargeText converts a UserWithLargeText back to User.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination User message (if nil, a new one is created)
//   - src: Source UserWithLargeText entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted User message
//   - Error if conversion fails
func UserFromUserWithLargeText(
	dest *api.User,
	src *UserWithLargeText,
	decorator func(*api.User, *UserWithLargeText) error,
) (out *api.User, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.User{}
	}

	// Initialize struct with inline values
	*dest = api.User{
		Id:    uint32(mustParseUint(src.Id)),
		Name:  src.Name,
		Email: src.Email,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserToUserSimple converts a User to UserSimple.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source User message to convert from
//   - dest: Destination UserSimple entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted UserSimple entity
//   - Error if conversion fails
func UserToUserSimple(
	src *api.User,
	dest *UserSimple,
	decorator func(*api.User, *UserSimple) error,
) (out *UserSimple, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &UserSimple{}
	}

	// Initialize struct with inline values
	*dest = UserSimple{
		Id:   strconv.FormatUint(uint64(src.Id), 10),
		Name: src.Name,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserFromUserSimple converts a UserSimple back to User.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination User message (if nil, a new one is created)
//   - src: Source UserSimple entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted User message
//   - Error if conversion fails
func UserFromUserSimple(
	dest *api.User,
	src *UserSimple,
	decorator func(*api.User, *UserSimple) error,
) (out *api.User, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.User{}
	}

	// Initialize struct with inline values
	*dest = api.User{
		Id:   uint32(mustParseUint(src.Id)),
		Name: src.Name,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// AuthorToAuthorDatastore converts a Author to AuthorDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source Author message to convert from
//   - dest: Destination AuthorDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted AuthorDatastore entity
//   - Error if conversion fails
func AuthorToAuthorDatastore(
	src *api.Author,
	dest *AuthorDatastore,
	decorator func(*api.Author, *AuthorDatastore) error,
) (out *AuthorDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &AuthorDatastore{}
	}

	// Initialize struct with inline values
	*dest = AuthorDatastore{
		Name:  src.Name,
		Email: src.Email,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// AuthorFromAuthorDatastore converts a AuthorDatastore back to Author.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination Author message (if nil, a new one is created)
//   - src: Source AuthorDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted Author message
//   - Error if conversion fails
func AuthorFromAuthorDatastore(
	dest *api.Author,
	src *AuthorDatastore,
	decorator func(*api.Author, *AuthorDatastore) error,
) (out *api.Author, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Author{}
	}

	// Initialize struct with inline values
	*dest = api.Author{
		Name:  src.Name,
		Email: src.Email,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// ProductToProductDatastore converts a Product to ProductDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source Product message to convert from
//   - dest: Destination ProductDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted ProductDatastore entity
//   - Error if conversion fails
func ProductToProductDatastore(
	src *api.Product,
	dest *ProductDatastore,
	decorator func(*api.Product, *ProductDatastore) error,
) (out *ProductDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &ProductDatastore{}
	}

	// Initialize struct with inline values
	*dest = ProductDatastore{
		Id:         strconv.FormatUint(uint64(src.Id), 10),
		Name:       src.Name,
		Tags:       src.Tags,
		Categories: src.Categories,
		Metadata:   src.Metadata,
		Ratings:    src.Ratings,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// ProductFromProductDatastore converts a ProductDatastore back to Product.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination Product message (if nil, a new one is created)
//   - src: Source ProductDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted Product message
//   - Error if conversion fails
func ProductFromProductDatastore(
	dest *api.Product,
	src *ProductDatastore,
	decorator func(*api.Product, *ProductDatastore) error,
) (out *api.Product, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Product{}
	}

	// Initialize struct with inline values
	*dest = api.Product{
		Id:         uint32(mustParseUint(src.Id)),
		Name:       src.Name,
		Tags:       src.Tags,
		Categories: src.Categories,
		Metadata:   src.Metadata,
		Ratings:    src.Ratings,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// LibraryToLibraryDatastore converts a Library to LibraryDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source Library message to convert from
//   - dest: Destination LibraryDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted LibraryDatastore entity
//   - Error if conversion fails
func LibraryToLibraryDatastore(
	src *api.Library,
	dest *LibraryDatastore,
	decorator func(*api.Library, *LibraryDatastore) error,
) (out *LibraryDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &LibraryDatastore{}
	}

	// Initialize struct with inline values
	*dest = LibraryDatastore{
		Id:   strconv.FormatUint(uint64(src.Id), 10),
		Name: src.Name,
	}
	out = dest

	if src.Contributors != nil {
		out.Contributors = make([]AuthorDatastore, len(src.Contributors))
		for i, item := range src.Contributors {
			_, err = AuthorToAuthorDatastore(item, &out.Contributors[i], nil)
			if err != nil {
				return nil, fmt.Errorf("converting Contributors[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// LibraryFromLibraryDatastore converts a LibraryDatastore back to Library.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination Library message (if nil, a new one is created)
//   - src: Source LibraryDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted Library message
//   - Error if conversion fails
func LibraryFromLibraryDatastore(
	dest *api.Library,
	src *LibraryDatastore,
	decorator func(*api.Library, *LibraryDatastore) error,
) (out *api.Library, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Library{}
	}

	// Initialize struct with inline values
	*dest = api.Library{
		Id:   uint32(mustParseUint(src.Id)),
		Name: src.Name,
	}
	out = dest

	if src.Contributors != nil {
		out.Contributors = make([]*api.Author, len(src.Contributors))
		for i, item := range src.Contributors {
			out.Contributors[i], err = AuthorFromAuthorDatastore(nil, &item, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Contributors[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// OrganizationToOrganizationDatastore converts a Organization to OrganizationDatastore.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - src: Source Organization message to convert from
//   - dest: Destination OrganizationDatastore entity (if nil, a new one is created)
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted OrganizationDatastore entity
//   - Error if conversion fails
func OrganizationToOrganizationDatastore(
	src *api.Organization,
	dest *OrganizationDatastore,
	decorator func(*api.Organization, *OrganizationDatastore) error,
) (out *OrganizationDatastore, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &OrganizationDatastore{}
	}

	// Initialize struct with inline values
	*dest = OrganizationDatastore{
		Id:   strconv.FormatUint(uint64(src.Id), 10),
		Name: src.Name,
	}
	out = dest

	if src.Departments != nil {
		out.Departments = make(map[string]AuthorDatastore, len(src.Departments))
		for key, value := range src.Departments {
			var converted AuthorDatastore
			_, err = AuthorToAuthorDatastore(value, &converted, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Departments[%s]: %w", key, err)
			}
			out.Departments[key] = converted
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// OrganizationFromOrganizationDatastore converts a OrganizationDatastore back to Organization.
//
// The optional decorator function allows custom field transformations after conversion.
//
// Parameters:
//   - dest: Destination Organization message (if nil, a new one is created)
//   - src: Source OrganizationDatastore entity to convert from
//   - decorator: Optional function for custom transformations
//
// Returns:
//   - Converted Organization message
//   - Error if conversion fails
func OrganizationFromOrganizationDatastore(
	dest *api.Organization,
	src *OrganizationDatastore,
	decorator func(*api.Organization, *OrganizationDatastore) error,
) (out *api.Organization, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Organization{}
	}

	// Initialize struct with inline values
	*dest = api.Organization{
		Id:   uint32(mustParseUint(src.Id)),
		Name: src.Name,
	}
	out = dest

	if src.Departments != nil {
		out.Departments = make(map[string]*api.Author, len(src.Departments))
		for key, value := range src.Departments {
			out.Departments[key], err = AuthorFromAuthorDatastore(nil, &value, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Departments[%s]: %w", key, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return dest, nil
}
