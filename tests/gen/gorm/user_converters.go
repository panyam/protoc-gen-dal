// Code generated by protoc-gen-dal-gorm. DO NOT EDIT.
package gorm

import (
	"fmt"
	"time"

	api "github.com/panyam/protoc-gen-dal/tests/gen/go/api"

	"google.golang.org/protobuf/types/known/timestamppb"
)

// Helper functions for built-in type conversions

// timestampToInt64 converts a protobuf Timestamp to Unix seconds (int64).
// Returns 0 if timestamp is nil.
func timestampToInt64(ts *timestamppb.Timestamp) int64 {
	if ts == nil {
		return 0
	}
	return ts.AsTime().Unix()
}

// int64ToTimestamp converts Unix seconds (int64) to a protobuf Timestamp.
// Returns nil if the input is 0.
func int64ToTimestamp(seconds int64) *timestamppb.Timestamp {
	if seconds == 0 {
		return nil
	}
	return timestamppb.New(time.Unix(seconds, 0))
}

// UserToUserGORM converts a api.User to UserGORM.
// The optional decorator function allows custom field transformations.
func UserToUserGORM(
	src *api.User,
	dest *UserGORM,
	decorator func(*api.User, *UserGORM) error,
) (out *UserGORM, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &UserGORM{}
	}

	// Initialize struct with inline values
	*dest = UserGORM{
		Id:           src.Id,
		Name:         src.Name,
		Email:        src.Email,
		Age:          src.Age,
		MemberNumber: src.MemberNumber,
	}
	out = dest

	if src.Birthday != nil {
		out.Birthday = timestampToInt64(src.Birthday)
	}
	if src.ActivatedAt != nil {
		out.ActivatedAt = timestampToInt64(src.ActivatedAt)
	}
	if src.CreatedAt != nil {
		out.CreatedAt = timestampToInt64(src.CreatedAt)
	}
	if src.UpdatedAt != nil {
		out.UpdatedAt = timestampToInt64(src.UpdatedAt)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserFromUserGORM converts a UserGORM back to api.User.
// The optional decorator function allows custom field transformations.
func UserFromUserGORM(
	dest *api.User,
	src *UserGORM,
	decorator func(dest *api.User, src *UserGORM) error,
) (out *api.User, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.User{}
	}

	// Initialize struct with inline values
	*dest = api.User{
		Id:           src.Id,
		Name:         src.Name,
		Email:        src.Email,
		Age:          src.Age,
		Birthday:     int64ToTimestamp(src.Birthday),
		MemberNumber: src.MemberNumber,
		ActivatedAt:  int64ToTimestamp(src.ActivatedAt),
		CreatedAt:    int64ToTimestamp(src.CreatedAt),
		UpdatedAt:    int64ToTimestamp(src.UpdatedAt),
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}

// UserToUserWithPermissions converts a api.User to UserWithPermissions.
// The optional decorator function allows custom field transformations.
func UserToUserWithPermissions(
	src *api.User,
	dest *UserWithPermissions,
	decorator func(*api.User, *UserWithPermissions) error,
) (out *UserWithPermissions, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &UserWithPermissions{}
	}

	// Initialize struct with inline values
	*dest = UserWithPermissions{
		Id:    src.Id,
		Name:  src.Name,
		Email: src.Email,
	}
	out = dest

	if src.CreatedAt != nil {
		out.CreatedAt = timestampToInt64(src.CreatedAt)
	}
	if src.UpdatedAt != nil {
		out.UpdatedAt = timestampToInt64(src.UpdatedAt)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserFromUserWithPermissions converts a UserWithPermissions back to api.User.
// The optional decorator function allows custom field transformations.
func UserFromUserWithPermissions(
	dest *api.User,
	src *UserWithPermissions,
	decorator func(dest *api.User, src *UserWithPermissions) error,
) (out *api.User, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.User{}
	}

	// Initialize struct with inline values
	*dest = api.User{
		Id:        src.Id,
		Name:      src.Name,
		Email:     src.Email,
		CreatedAt: int64ToTimestamp(src.CreatedAt),
		UpdatedAt: int64ToTimestamp(src.UpdatedAt),
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}

// UserToUserWithCustomTimestamps converts a api.User to UserWithCustomTimestamps.
// The optional decorator function allows custom field transformations.
func UserToUserWithCustomTimestamps(
	src *api.User,
	dest *UserWithCustomTimestamps,
	decorator func(*api.User, *UserWithCustomTimestamps) error,
) (out *UserWithCustomTimestamps, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &UserWithCustomTimestamps{}
	}

	// Initialize struct with inline values
	*dest = UserWithCustomTimestamps{
		Id:   src.Id,
		Name: src.Name,
	}
	out = dest

	if src.CreatedAt != nil {
		out.CreatedAt = timestampToInt64(src.CreatedAt)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserFromUserWithCustomTimestamps converts a UserWithCustomTimestamps back to api.User.
// The optional decorator function allows custom field transformations.
func UserFromUserWithCustomTimestamps(
	dest *api.User,
	src *UserWithCustomTimestamps,
	decorator func(dest *api.User, src *UserWithCustomTimestamps) error,
) (out *api.User, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.User{}
	}

	// Initialize struct with inline values
	*dest = api.User{
		Id:        src.Id,
		Name:      src.Name,
		CreatedAt: int64ToTimestamp(src.CreatedAt),
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}

// UserToUserWithIndexes converts a api.User to UserWithIndexes.
// The optional decorator function allows custom field transformations.
func UserToUserWithIndexes(
	src *api.User,
	dest *UserWithIndexes,
	decorator func(*api.User, *UserWithIndexes) error,
) (out *UserWithIndexes, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &UserWithIndexes{}
	}

	// Initialize struct with inline values
	*dest = UserWithIndexes{
		Id:    src.Id,
		Name:  src.Name,
		Email: src.Email,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserFromUserWithIndexes converts a UserWithIndexes back to api.User.
// The optional decorator function allows custom field transformations.
func UserFromUserWithIndexes(
	dest *api.User,
	src *UserWithIndexes,
	decorator func(dest *api.User, src *UserWithIndexes) error,
) (out *api.User, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.User{}
	}

	// Initialize struct with inline values
	*dest = api.User{
		Id:    src.Id,
		Name:  src.Name,
		Email: src.Email,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}

// UserToUserWithDefaults converts a api.User to UserWithDefaults.
// The optional decorator function allows custom field transformations.
func UserToUserWithDefaults(
	src *api.User,
	dest *UserWithDefaults,
	decorator func(*api.User, *UserWithDefaults) error,
) (out *UserWithDefaults, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &UserWithDefaults{}
	}

	// Initialize struct with inline values
	*dest = UserWithDefaults{
		Id:   src.Id,
		Name: src.Name,
	}
	out = dest

	if src.CreatedAt != nil {
		out.CreatedAt = timestampToInt64(src.CreatedAt)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// UserFromUserWithDefaults converts a UserWithDefaults back to api.User.
// The optional decorator function allows custom field transformations.
func UserFromUserWithDefaults(
	dest *api.User,
	src *UserWithDefaults,
	decorator func(dest *api.User, src *UserWithDefaults) error,
) (out *api.User, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.User{}
	}

	// Initialize struct with inline values
	*dest = api.User{
		Id:        src.Id,
		Name:      src.Name,
		CreatedAt: int64ToTimestamp(src.CreatedAt),
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}

// AuthorToAuthorGORM converts a api.Author to AuthorGORM.
// The optional decorator function allows custom field transformations.
func AuthorToAuthorGORM(
	src *api.Author,
	dest *AuthorGORM,
	decorator func(*api.Author, *AuthorGORM) error,
) (out *AuthorGORM, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &AuthorGORM{}
	}

	// Initialize struct with inline values
	*dest = AuthorGORM{
		Name:  src.Name,
		Email: src.Email,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// AuthorFromAuthorGORM converts a AuthorGORM back to api.Author.
// The optional decorator function allows custom field transformations.
func AuthorFromAuthorGORM(
	dest *api.Author,
	src *AuthorGORM,
	decorator func(dest *api.Author, src *AuthorGORM) error,
) (out *api.Author, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Author{}
	}

	// Initialize struct with inline values
	*dest = api.Author{
		Name:  src.Name,
		Email: src.Email,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}

// BlogToBlogGORM converts a api.Blog to BlogGORM.
// The optional decorator function allows custom field transformations.
func BlogToBlogGORM(
	src *api.Blog,
	dest *BlogGORM,
	decorator func(*api.Blog, *BlogGORM) error,
) (out *BlogGORM, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &BlogGORM{}
	}

	// Initialize struct with inline values
	*dest = BlogGORM{
		Id:      src.Id,
		Upvotes: src.Upvotes,
		Title:   src.Title,
	}
	out = dest

	if src.Author != nil {
		_, err = AuthorToAuthorGORM(src.Author, &out.Author, nil)
		if err != nil {
			return nil, fmt.Errorf("converting Author: %w", err)
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// BlogFromBlogGORM converts a BlogGORM back to api.Blog.
// The optional decorator function allows custom field transformations.
func BlogFromBlogGORM(
	dest *api.Blog,
	src *BlogGORM,
	decorator func(dest *api.Blog, src *BlogGORM) error,
) (out *api.Blog, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Blog{}
	}

	// Initialize struct with inline values
	*dest = api.Blog{
		Id:      src.Id,
		Upvotes: src.Upvotes,
		Title:   src.Title,
	}
	out = dest

	_, err = AuthorFromAuthorGORM(out.Author, &src.Author, nil)
	if err != nil {
		return nil, fmt.Errorf("converting Author: %w", err)
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}

// ProductToProductGORM converts a api.Product to ProductGORM.
// The optional decorator function allows custom field transformations.
func ProductToProductGORM(
	src *api.Product,
	dest *ProductGORM,
	decorator func(*api.Product, *ProductGORM) error,
) (out *ProductGORM, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &ProductGORM{}
	}

	// Initialize struct with inline values
	*dest = ProductGORM{
		Id:         src.Id,
		Name:       src.Name,
		Tags:       src.Tags,
		Categories: src.Categories,
		Ratings:    src.Ratings,
	}
	out = dest

	if src.Metadata != nil {
		out.Metadata = src.Metadata
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// ProductFromProductGORM converts a ProductGORM back to api.Product.
// The optional decorator function allows custom field transformations.
func ProductFromProductGORM(
	dest *api.Product,
	src *ProductGORM,
	decorator func(dest *api.Product, src *ProductGORM) error,
) (out *api.Product, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Product{}
	}

	// Initialize struct with inline values
	*dest = api.Product{
		Id:         src.Id,
		Name:       src.Name,
		Tags:       src.Tags,
		Categories: src.Categories,
		Metadata:   src.Metadata,
		Ratings:    src.Ratings,
	}
	out = dest

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}

// LibraryToLibraryGORM converts a api.Library to LibraryGORM.
// The optional decorator function allows custom field transformations.
func LibraryToLibraryGORM(
	src *api.Library,
	dest *LibraryGORM,
	decorator func(*api.Library, *LibraryGORM) error,
) (out *LibraryGORM, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &LibraryGORM{}
	}

	// Initialize struct with inline values
	*dest = LibraryGORM{
		Id:   src.Id,
		Name: src.Name,
	}
	out = dest

	if src.Contributors != nil {
		out.Contributors = make([]AuthorGORM, len(src.Contributors))
		for i, item := range src.Contributors {
			_, err = AuthorToAuthorGORM(item, &out.Contributors[i], nil)
			if err != nil {
				return nil, fmt.Errorf("converting Contributors[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// LibraryFromLibraryGORM converts a LibraryGORM back to api.Library.
// The optional decorator function allows custom field transformations.
func LibraryFromLibraryGORM(
	dest *api.Library,
	src *LibraryGORM,
	decorator func(dest *api.Library, src *LibraryGORM) error,
) (out *api.Library, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Library{}
	}

	// Initialize struct with inline values
	*dest = api.Library{
		Id:   src.Id,
		Name: src.Name,
	}
	out = dest

	if src.Contributors != nil {
		out.Contributors = make([]*api.Author, len(src.Contributors))
		for i, item := range src.Contributors {
			out.Contributors[i], err = AuthorFromAuthorGORM(nil, &item, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Contributors[%d]: %w", i, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}

// OrganizationToOrganizationGORM converts a api.Organization to OrganizationGORM.
// The optional decorator function allows custom field transformations.
func OrganizationToOrganizationGORM(
	src *api.Organization,
	dest *OrganizationGORM,
	decorator func(*api.Organization, *OrganizationGORM) error,
) (out *OrganizationGORM, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &OrganizationGORM{}
	}

	// Initialize struct with inline values
	*dest = OrganizationGORM{
		Id:   src.Id,
		Name: src.Name,
	}
	out = dest

	if src.Departments != nil {
		out.Departments = make(map[string]AuthorGORM, len(src.Departments))
		for key, value := range src.Departments {
			var converted AuthorGORM
			_, err = AuthorToAuthorGORM(value, &converted, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Departments[%s]: %w", key, err)
			}
			out.Departments[key] = converted
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(src, dest); err != nil {
			return nil, err
		}
	}

	return dest, nil
}

// OrganizationFromOrganizationGORM converts a OrganizationGORM back to api.Organization.
// The optional decorator function allows custom field transformations.
func OrganizationFromOrganizationGORM(
	dest *api.Organization,
	src *OrganizationGORM,
	decorator func(dest *api.Organization, src *OrganizationGORM) error,
) (out *api.Organization, err error) {
	if src == nil {
		return nil, nil
	}
	if dest == nil {
		dest = &api.Organization{}
	}

	// Initialize struct with inline values
	*dest = api.Organization{
		Id:   src.Id,
		Name: src.Name,
	}
	out = dest

	if src.Departments != nil {
		out.Departments = make(map[string]*api.Author, len(src.Departments))
		for key, value := range src.Departments {
			out.Departments[key], err = AuthorFromAuthorGORM(nil, &value, nil)
			if err != nil {
				return nil, fmt.Errorf("converting Departments[%s]: %w", key, err)
			}
		}
	}

	// Apply decorator if provided
	if decorator != nil {
		if err := decorator(dest, src); err != nil {
			return nil, err
		}
	}

	return out, nil
}
